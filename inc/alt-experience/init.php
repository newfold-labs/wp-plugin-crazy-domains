<?php
add_action(
	'admin_menu',
	function () {
		add_menu_page(
			'Crazy Domains',
			'Crazy Domains',
			'manage_options',
			'crazy-domains',
			function () {
				$version   = CRAZYDOMAINS_PLUGIN_VERSION;
				$asset_file = CRAZYDOMAINS_BUILD_DIR . '/index.asset.php';
				if ( is_readable( $asset_file ) ) {
					$asset   = include_once $asset_file;
					$version = $asset['version'];
				}

				wp_enqueue_style(
					'crazy-domains-style',
					CRAZYDOMAINS_BUILD_URL . '/index.css',
					array( 'wp-components' ),
					$version
				);

				echo file_get_contents( __DIR__ . '/index.html' ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped, WordPress.WP.AlternativeFunctions.file_get_contents_file_get_contents
			},
			'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIxLjMzNzEgNy41MzkzM0MyMC42OTY2IDcuMTM0ODMgMTkuODUzOSA2LjkzMjU5IDE4LjgwOSA2LjkzMjU5SDE0LjM1OTZMMTAuNjUxNyAxOC45MzI2SDE1LjAzMzdDMTYuMDc4NyAxOC45MzI2IDE3LjA1NjIgMTguNzMwMyAxNy45NjYzIDE4LjM5MzNDMTguODc2NCAxOC4wMjI1IDE5LjY4NTQgMTcuNTE2OSAyMC40MjcgMTYuODQyN0MyMS4xMzQ4IDE2LjIwMjIgMjEuNzA3OSAxNS4zOTMzIDIyLjE3OTggMTQuNTE2OUMyMi42NTE3IDEzLjY0MDUgMjIuODg3NiAxMi42NjI5IDIyLjk4ODggMTEuNTg0M0MyMy4wODk5IDEwLjcwNzkgMjIuOTg4OCA5Ljg5ODg4IDIyLjY4NTQgOS4yMjQ3MkMyMi40NDk0IDguNDgzMTUgMjIuMDExMiA3Ljk0MzgyIDIxLjMzNzEgNy41MzkzM1pNMTkuNjg1NCAxMi4wNTYyQzE5LjY1MTcgMTIuNTk1NSAxOS40ODMxIDEzLjEwMTEgMTkuMzE0NiAxMy42MDY3QzE5LjExMjQgMTQuMDc4NyAxOC44NDI3IDE0LjU1MDYgMTguNTA1NiAxNC44ODc2QzE4LjE2ODUgMTUuMjU4NCAxNy43OTc4IDE1LjU2MTggMTcuMzkzMyAxNS43NjRDMTYuOTU1MSAxNS45NjYzIDE2LjUxNjkgMTYuMTAxMSAxNi4wMTEyIDE2LjEwMTFIMTQuNzY0TDE2Ljc4NjUgOS42MjkyMkgxOEMxOC40MzgyIDkuNjI5MjIgMTguNzc1MyA5LjczMDM0IDE5LjA0NDkgOS45MzI1OUMxOS4zNDgzIDEwLjEzNDggMTkuNTE2OSAxMC40MDQ1IDE5LjY1MTcgMTAuNzc1M0MxOS42ODU0IDExLjE0NjEgMTkuNzE5MSAxMS41ODQzIDE5LjY4NTQgMTIuMDU2MloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik01Ljg5ODg4IDE0LjIwMjJDNS44NjUxNyAxNC4yMDIyIDUuNzk3NzYgMTQuMjAyMiA1Ljc2NDA1IDE0LjIwMjJDNS4yOTIxNCAxNC4yMDIyIDQuODg3NjQgMTQuMDMzNyA0LjY1MTY5IDEzLjczMDNDNC4xMTIzNiAxMy4wMjI1IDQuMzQ4MzIgMTEuNzQxNiA0LjUxNjg2IDExLjAzMzdDNC42MTc5OCAxMC42OTY2IDUuNDYwNjggNy43OTc3NiA3LjQ0OTQ0IDcuNTYxOEM3LjcxOTEgNy41MjgwOSA3LjkyMTM1IDcuNTk1NTEgOC4wNTYxOCA3Ljc2NDA1QzguMjU4NDMgOC4wMzM3MSA4LjMyNTg1IDguNTM5MzMgOC4xOTEwMSA5LjI4MDlMMTEuMjI0NyA4Ljg3NjQxQzExLjU2MTggNy42OTY2MyAxMS40NjA3IDYuNzUyODEgMTAuOTU1MSA2LjA3ODY1QzEwLjE3OTggNS4wMzM3MSA4LjY5NjYzIDQuOTMyNTkgOC4wODk4OSA0LjkzMjU5QzcuOTIxMzUgNC45MzI1OSA3Ljc1MjgxIDQuOTMyNTkgNy41ODQyNyA0Ljk2NjI5QzQuMzgyMDMgNS4zMDMzNyAxLjU4NDI3IDguMTAxMTMgMC45Nzc1MzEgMTEuNjQwNUMwLjcwNzg2OCAxMy4xMjM2IDEuMDExMjQgMTQuNDcxOSAxLjg1Mzk0IDE1LjQ4MzFDMi42MjkyMiAxNi40MjcgMy44NzY0MSAxNi45NjYzIDUuMjU4NDMgMTYuOTY2M0M1LjQ5NDM5IDE2Ljk2NjMgNS43MzAzNCAxNi45MzI2IDUuOTY2MyAxNi45MzI2QzguNzY0MDUgMTYuNTk1NSAxMC40MTU3IDE1LjI0NzIgMTEuMTIzNiAxMi44MjAyTDcuOTg4NzcgMTIuNjUxN0M3Ljg1Mzk0IDEzLjE1NzMgNy4yODA5IDE0LjEwMTEgNS44OTg4OCAxNC4yMDIyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+',
			1
		);
	}
);

$bust_mode_path = CRAZYDOMAINS_PLUGIN_DIR . 'vendor/newfold-labs/wp-module-performance/includes/BurstSafetyMode/init.php';
if ( file_exists( $bust_mode_path ) ) {
	require_once $bust_mode_path;
}
